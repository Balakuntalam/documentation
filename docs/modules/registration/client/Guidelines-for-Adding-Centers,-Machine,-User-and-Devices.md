## List of Contents
* [1. Sample Seed Data](#1-seed-data-source-files-in-csv-format)
* [2. Steps to add seed data](#2-steps-to-add-seed-data)
	* [2.1 Create roles in Keycloak](#21-create-roles-in-keycloak)
	* [2.2 Create a Registration Center](#22-create-a-registration-center)
	* [2.3 Create a Machine](#23-create-a-machine)
	* [2.4 Create a User](#24-create-a-user)
	* [2.5 Create a Device](#25-create-a-device)
	* [2.6 Map the User to a Zone](#26-map-the-user-to-a-zone)
	* [2.7 Map the Machine to a Center](#27-map-the-machine-to-a-center)
	* [2.8 Map the User to a Center](#28-map-the-user-to-a-center)
	* [2.9 Map the Device to a Center](#29-map-the-device-to-a-center)
	* [2.10 Map Center-Machine-Device](#210-map-center-machine-device)
	* [2.11 Map Center-Machine-User](#211-map-center-machine-user)
	* [2.12 Store History of master data](#212-store-history-of-master data)
* [3. Load updated CSVs to the database using dml sql script](#3-Load-updated-CSVs-to-the-database-using-dml-sql-script)

## 1. Seed Data Source files (in CSV format)
* Registration Centers: [**master-registration_center**](https://github.com/mosip/commons/tree/master/db_scripts/mosip_master/dml/master-registration_center.csv)
* Machines: [**master-machine_master**](https://github.com/mosip/commons/tree/master/db_scripts/mosip_master/dml/master-machine_master.csv)
* Users: [**master-user_detail**](https://github.com/mosip/commons/tree/master/db_scripts/mosip_master/dml/master-user_detail.csv)
* Devices: [**master-device_master**](https://github.com/mosip/commons/tree/master/db_scripts/mosip_master/dml/master-device_master.csv)
* Center-Machine Mapping: [**master-reg_center_machine**](https://github.com/mosip/commons/tree/master/db_scripts/mosip_master/dml/master-reg_center_machine.csv)
* Center-Device Mapping: [**master-reg_center_device**](https://github.com/mosip/commons/tree/master/db_scripts/mosip_master/dml/master-reg_center_device.csv)
* Center-User Mapping: [**master-reg_center_user**](https://github.com/mosip/commons/tree/master/db_scripts/mosip_master/dml/master-reg_center_user.csv)
* Center-Machine-Device Mapping: [**master-reg_center_user_machine**](https://github.com/mosip/commons/tree/master/db_scripts/mosip_master/dml/master-reg_center_user_machine.csv)
* Center Machine User Mapping: [**master-reg_center_machine_device**](https://github.com/mosip/commons/tree/master/db_scripts/mosip_master/dml/master-reg_center_machine_device.csv)
* User Zone Mapping: [**master-zone_user**](https://github.com/mosip/commons/tree/master/db_scripts/mosip_master/dml/master-zone_user.csv)

## 2. Steps to Add seed data:

### 2.1 Create Roles in Keycloak

Before creating the master data, roles used across MOSIP are needed to be created in Keycloak.

Following roles have to be created using the process as mentioned above.([Refer here]() for help on how to create roles in Keycloak.)

* REGISTRATION_ADMIN
* REGISTRATION_SUPERVISOR
* REGISTRATION_OFFICER
* ZONAL_ADMIN
* GLOBAL_ADMIN
* AUTH
* PREREG
* REGISTRATION_PROCESSOR
* ID_AUTHENTICATION
* PRE_REGISTRATION_ADMIN
* Default

### 2.2 Create a Registration Center

* **Center ID**: When creating a Center through an API, a Center ID gets generated by MOSIP. If created through scripts, Center ID needs to be manually stored and should follow the below rules
	* It should be a 5-digit ID and should be in an incremental sequence for each center added.
	* The sequence should start from 10000. Keeping the length other than 5 digits will fail validations as the same Center ID is used to generate the Request ID (Registration ID). 
	* For each Center created, Center ID should be incremented sequentially to avoid inconsistency in data.
* **Center Name**: Name of the Center as required by the Country
* **Center Type Code**: Center Type Code will come from a Center Type master data which currently have one center Type defined as "Regular" and Code as "REG". More Center Types can be defined by the country in the Center Type master data.
* **Address Line 1**: It is an Optional Field but should be defined to be visible to the resident on the Pre-Registration UI
* **Address Line 2**: It is an Optional Field
* **Address Line 3**: It is an Optional Field
* **Latitude**: Should be defined in format **XX.XXXX**. minimum 4 digits are need after the decimal for the accuracy to be atleast 11 meters on the GPS map on Pre-Registration Portal
* **Longitude**: Should be defined in format **XX.XXXX**. minimum 4 digits are need after the decimal for the accuracy to be atleast 11 meters on the GPS map on Pre-Registration Portal
* **Location Code**: This field maps the Registration Center to a Location. This should be a location code referring to a Location defined in the location master data table. It should always be the code of the location which is at the lowest hierarchy level
* **Contact Phone**: An optional field. Usually a point of contact for a Registration Center
* **Contact Person**: An optional field. Should be the name of the person who is a point of contact for a Registration Center
* **Number of Kiosk**: Number of Registration Kiosk a Registration Center will have to register residents. This number is used by the pre-registration to calculate appointment slots for Registration. This should always be equal to the number of machines assigned to the Center or which will be assigned to the Center. Refer [**point 2.5**](#25-map-the-machine-to-a-center) in steps below
* **Working Hours**: Should be the difference of "**Center Start Time**" and "**Center End Time**". Should be in format **hh:mm:ss**
* **Per Kiosk Processing time**: Duration of Registration Appointment defined as per the country requirement. This attribute is used by pre-Registration to calculate appointment slots. Should be in format **hh:mm:ss**
* **Center Start Time**: Time when Center would start taking registration of Residents. This time is used by Pre-Registration to calculate appointment slots. Should be in format **hh:mm:ss**
* **Center End Time**: Time when the Center closes. This time is used by Pre-Registration to calculate appointment slots. Should be in format **hh:mm:ss**
* **Lunch Start Time**: Starting of Lunch Time the Center would have in-between the Working hours. It is used by Pre-Registration to calculate appointment slots. Should be in format **hh:mm:ss**. This is an optional field.
* **Lunch End Time**: Ending of Lunch Time the Center would have in-between the Working hours. It is used by Pre-Registration to calculate appointment slots. Should be in format **hh:mm:ss**. This is an optional field.
* **Time Zone**: Time zone of a country. Should be in this format - (GTM+01:00) CENTRAL EUROPEAN TIME
* **Holiday Location Code**: It refers to a code of a location which belongs to the holiday locatiom hierarchy level defined by the country in the configuration. This hierarchy level defines a level to which a country decides to map holidays to.
* **Zone Code**: Contains the Administrative Zone code to which the Registration Center should be tagged to. The Administrative Zones are defined by a country to better manage the resources(Centers, Machines and Devices) used in Registration Process. These are defined in master data table 'zone' in hierarchical fashion similar to Location master data. For Centers, this should always be the lowest level Administrative Zone code.
* **Language Code**: Should be the language code for the languages supported by the Country as primary/secondary Language. (E.g English - eng, French - fra, Arabic - ara)
* **Is_Active**: TRUE. If set as false, this will make the Center as Inactive and the Center will not show up on the Pre-Registration UI and no appointments will be generated for this Center
* **cr_by**: `<username>` Ideally username of the admin creating the center
* **cr_dtimes**: The time at which the Center is getting created

{% hint style="info" %}
A Registration Center is needed to be created in all the languages supported by the country. if a country supports primary language as French and Secondary language as arabic, create the same registration center twice. One with language code as **fra** for French and one with language code as **ara** for Arabic. Center ID should be same for both the records as both the records are for one center only.
{% endhint %}

### 2.3 Create a Machine:
* **Machine ID**: When creating a Machine through an API, a Machine ID gets generated by MOSIP. If created thorugh scripts, Machine ID needs to be manually stored and should follow the below rules
	* It should be a 5-digit ID and should be in an incremental sequence for each center added. 
	* The sequence should start from 10000. Keeping the length other than 5 digits will fail validations as the same Machine ID is used to generate the Request ID (Registration ID). 
	* For each Machine created, Machine ID should be incremented sequentially to avoid inconsistency in data.
* **Machine Name**: Machine Host name
* **Machine Mac-Address**: Machineâ€™s Mac-Address
* **Serial Number**: `<serial number of machine>`
* **IP Address**: It is an optional field and can be left blank
* **Mspecid**: These ID will come from a Machine Spec table. Putting any value other than these will throw an error. This value refers to a Machine specification (brand, model etc) a Machine belongs to.
* **Zone Code**: Contains the Administrative Zone code to which the Machine should be tagged to. The Administrative Zones are defined by a country to better manage the resources(Centers, Machines and Devices) used in Registration Process. These are defined in master data table 'zone' in hierarchical fashion similar to Location master data. For Machines, this value can exist at any level of the hierarchy
* **Lang_code**: eng
* **Is_active**: True. If kept as false, the Machine will be marked as Inactive
* **cr_by**: `<username>` Ideally username of the admin who is creating the Machine
* **cr_dtimes**: Should be the timestamp at which the Machine is being created

### 2.4 Create a User
* Create a User in Keycloak (User ID/Password)
* Create a User in DB
	* **Id**: ID used in Keycloak
	* **UIN**: It is an optional field. Can be left blank as this field is not used anywhere
	* **Email**: Email used in Keycloak
	* **Mobile**: Mobile used in Keycloak
	* **status_code**: ACT
	* **lang_code**: eng
	* **last_login_method**: PWD
	* **Is_active**: True
	* **cr_by**: `<username>` ideally name of the admin
	* **cr_dtimes**: now()

### 2.5 Create a Device
* **Device ID**: This can be a random ID.
* **Device Name**: `<Name of the device>`
* **Device Mac-Address**: `<mac-address of device>`
* **Serial Number**: `<serial number of device>`
* **IP Address**: Leave it blank
* **Dspecid**: These ID will come from a Device Spec table. Putting any value other than these will throw an error. This value refers to a Device specification (brand, model etc) a Machine belongs to.
* **Zone Code**: Contains the Administrative Zone code to which the Device should be tagged to. The Administrative Zones are defined by a country to better manage the resources(Centers, Machines and Devices) used in Registration Process. These are defined in master data table 'zone' in hierarchical fashion similar to location master data. For Devices, this value can exist at any level of the hierarchy
* **Lang_code**: eng
* **Is_active**: True
* **cr_by**: `<username>` Ideally username of the admin who is creating the Device
* **cr_dtimes**: Current time at which the Device is being created

### 2.6 Map the User to a Zone
* **User ID**: from master_userdetail
* **Zone_code**: Contains the Administrative Zone code to which the User should be tagged to. The Administrative Zones are defined by a country to better manage the resources(Centers, Machines and Devices) used in Registration Process. These are defined in master data table 'zone' in hierarchical fashion similar to location master data. For Users, this value can exist at any level of the hierarchy.

{% hint style="info" %}
While mapping Machine, User, Device to a Center in points 2.6, 2.7, 2.8, 2.9, 2.10, these resources should belong to the same hierearchy chain of the Administrative zones. For example, If the Device is mapped to Zone 1 and Center is mapped to Zone 2. For mapping Device to the Center, Zone 2 should either be same as Zone 1 or should exist only under the hierarchy of Zone 1.
{% endhint %}

### 2.7 Map the Machine to a Center
* **Center ID**: from **master-registration_center**
* **Machine ID**: from **master-machine_master** (newly created machine)
* **Lang_code**: Primary language defined by the country
* **Is_active**: True. If kept as false, the Center and Machine will not be considered as mapped
* **cr_by**: `<username>` Ideally username of the admin creating the mapping
* **cr_dtimes**: Should be the current time at which the mapping is being created

### 2.8 Map the User to a Center
Follow the above example in [**point 2.4**](#24-create-a-device).

### 2.9 Map the Device to a Center
Follow the above example in [**point 2.4**](#24-create-a-device).

### 2.10 Map Center-Machine-Device
Follow the above example in [**point 2.4**](#24-create-a-device).

### 2.11 Map Center-Machine-User
Follow the above example in [**point 2.4**](#24-create-a-device).

### 2.12 Store History of master data 
After adding all these data in the DB, we would need to create the same records in all the History tables for every table mentioned in the "**Tables Names**" section.
1. Each history table has an extra attribute "effective date" other than the standard attributes mentioned for each table. 
1. The Effective date should be the current time at which the record is being created and all the attributes should be same as they are stored in the standard tables.
1. Find the table names below for history tables
   1. Registration Centers: [**master-registration_center_h**](https://github.com/mosip/commons/tree/master/db_scripts/mosip_master/dml/master-registration_center_h.csv)
   1. Machines: [**master-machine_master_h**](https://github.com/mosip/commons/tree/master/db_scripts/mosip_master/dml/master-machine_master_h.csv)
   1. Users: [**master-user_detail_h**](https://github.com/mosip/commons/tree/master/db_scripts/mosip_master/dml/master-user_detail_h.csv)
   1. Devices: [**master-device_master_h**](https://github.com/mosip/commons/tree/master/db_scripts/mosip_master/dml/master-device_master_h.csv)
   1. Center-Machine Mapping: [**master-reg_center_machine_h**](https://github.com/mosip/commons/tree/master/db_scripts/mosip_master/dml/master-reg_center_machine_h.csv)
   1. Center-Device Mapping: [**master-reg_center_device_h**](https://github.com/mosip/commons/tree/master/db_scripts/mosip_master/dml/master-reg_center_device_h.csv)
   1. Center-User Mapping: [**master-reg_center_user_h**](https://github.com/mosip/commons/tree/master/db_scripts/mosip_master/dml/master-reg_center_user_h.csv)
   1. Center-Machine-Device Mapping: [**master-reg_center_user_machine_h**](https://github.com/mosip/commons/tree/master/db_scripts/mosip_master/dml/master-reg_center_user_machine_h.csv)
   1. Center Machine User Mapping: [**master-reg_center_machine_device_h**](https://github.com/mosip/commons/tree/master/db_scripts/mosip_master/dml/master-reg_center_machine_device_h.csv)
   1. User Zone Mapping: [**master-zone_user_h**](https://github.com/mosip/commons/tree/master/db_scripts/mosip_master/dml/master-zone_user_h.csv)

## 3. Load updated CSVs to the database using dml sql script:
Run dml sql scripts on DB server where master seed data needs to be updates.

`mosip_master=#\ir '/mosip/mosip-platform/blob/master/db_scripts/mosip_master/mosip_master_dml_deploy.sql'`
